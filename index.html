<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Calculus I Keyword Trainer</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			max-width: 800px;
			margin: 40px auto;
			line-height: 1.6;
		}
		#problemBox {
			background: #f0f4ff;
			padding: 15px;
			border-radius: 8px;
			margin-bottom: 20px;
		}
		select {
			font-size: 1em;
			margin: 5px 0;
			padding: 5px;
			width: 100%;
			box-sizing: border-box;
		}
		button {
			margin-top: 10px;
			padding: 8px 14px;
			cursor: pointer;
		}
		.feedback {
			margin-top: 10px;
			font-weight: bold;
		}
		.explanation {
			background: #f9f9f9;
			border-left: 4px solid #ccc;
			padding: 10px;
			margin-top: 10px;
		}
	</style>
</head>
<body>

	<h1>Calculus I Word Problem Keyword Trainer</h1>

	<div id="problemBox"></div>
	<div id="questionsBox"></div>
	<button id="submitBtn">Check Answers</button>
	<div id="feedback"></div>
	<div id="nextContainer" style="margin-top:20px; display:none;">
		<button id="nextBtn">Next Problem</button>
	</div>

	<script src="questions.js"></script>
	<script>
	let current = 0;

	function loadProblem() {
		const p = problems[current];
		document.getElementById("problemBox").innerHTML =
			`<b>Problem ${current+1} of ${problems.length}:</b><br>${p.text}`;
		
		let html = "";
		p.questions.forEach((q, i) => {
			html += `<div><label><b>${q.prompt}</b></label><br>`;

			if (q.type === "select") {
				html += `<select id="q${i}">`;
				html += `<option value="">-- choose --</option>`;
				q.options.forEach(opt => html += `<option value="${opt}">${opt}</option>`);
				html += `</select>`;
			}
			else if (q.type === "checkbox") {
				q.options.forEach(opt => {
					html += `<label><input type="checkbox" name="q${i}" value="${opt}"> ${opt}</label><br>`;
				});
			}
			html += `</div>`;
		});
		document.getElementById("questionsBox").innerHTML = html;
		document.getElementById("feedback").innerHTML = "";
		document.getElementById("nextContainer").style.display = "none";
	}

	document.getElementById("submitBtn").addEventListener("click", () => {
		const p = problems[current];
		let output = "";

		p.questions.forEach((q, i) => {
			let correct = false;
			let user = "";

			if (q.type === "select") {
				user = document.getElementById(`q${i}`).value.trim();
				correct = user.toLowerCase() === q.answer.toLowerCase();
			} 
			else if (q.type === "checkbox") {
				const boxes = document.querySelectorAll(`input[name="q${i}"]:checked`);
				user = Array.from(boxes).map(b => b.value);
				const correctAnswers = q.answers.map(a => a.toLowerCase());
				const userAnswers = user.map(a => a.toLowerCase());
				correct =
					correctAnswers.length === userAnswers.length &&
					correctAnswers.every(a => userAnswers.includes(a));
			}

			if (correct) {
				output += `<div class="feedback" style="color:green;">Q${i+1}: Correct!</div>`;
			} else {
				const display = Array.isArray(user) ? user.join(", ") : user;
				output += `<div class="feedback" style="color:red;">Q${i+1}: Incorrect (You said "${display}", correct is "${Array.isArray(q.answers)? q.answers.join(", ") : q.answer}")</div>`;
			}
		});

		output += `<div class="explanation">${p.explanation}</div>`;
		document.getElementById("feedback").innerHTML = output;
		document.getElementById("nextContainer").style.display = "block";
	});

	document.getElementById("nextBtn").addEventListener("click", () => {
		current++;
		if (current >= problems.length) {
			document.getElementById("problemBox").innerHTML = "<b>All problems complete!</b>";
			document.getElementById("questionsBox").innerHTML = "";
			document.getElementById("feedback").innerHTML =
				"<p>Youâ€™ve finished this practice set. Replace <code>questions.js</code> with a new packet for more practice.</p>";
			document.getElementById("nextContainer").style.display = "none";
			return;
		}
		loadProblem();
	});

	loadProblem();
	</script>
</body>
</html>
